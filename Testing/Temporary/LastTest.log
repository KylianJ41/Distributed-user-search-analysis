Start testing: Aug 07 16:07 CEST
----------------------------------------------------------
1/4 Testing: MasterNodeTest
1/4 Test: MasterNodeTest
Command: "/home/kylian/Documents/Code/cpp/UserAnalysis/masternode_test"
Directory: /home/kylian/Documents/Code/cpp/UserAnalysis
"MasterNodeTest" start time: Aug 07 16:07 CEST
Output:
----------------------------------------------------------
[==========] Running 6 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 6 tests from MasterNodeTest
[ RUN      ] MasterNodeTest.InitializeTaskQueue
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
Initializing task queue with 1000 total users and 100 users per task
Created task with ID: task_1
Created task with ID: task_2
Created task with ID: task_3
Created task with ID: task_4
Created task with ID: task_5
Created task with ID: task_6
Created task with ID: task_7
Created task with ID: task_8
Created task with ID: task_9
Created task with ID: task_10
Finished initializing task queue. Total tasks created: 10
[       OK ] MasterNodeTest.InitializeTaskQueue (43 ms)
[ RUN      ] MasterNodeTest.GetNextTaskSuccess
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
Initializing task queue with 1000 total users and 100 users per task
Created task with ID: task_1
Created task with ID: task_2
Created task with ID: task_3
Created task with ID: task_4
Created task with ID: task_5
Created task with ID: task_6
Created task with ID: task_7
Created task with ID: task_8
Created task with ID: task_9
Created task with ID: task_10
Finished initializing task queue. Total tasks created: 10
[       OK ] MasterNodeTest.GetNextTaskSuccess (23 ms)
[ RUN      ] MasterNodeTest.GetNextTaskEmptyQueue
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
[       OK ] MasterNodeTest.GetNextTaskEmptyQueue (13 ms)
[ RUN      ] MasterNodeTest.SubmitTaskResult
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
Initializing task queue with 1000 total users and 100 users per task
Created task with ID: task_1
Created task with ID: task_2
Created task with ID: task_3
Created task with ID: task_4
Created task with ID: task_5
Created task with ID: task_6
Created task with ID: task_7
Created task with ID: task_8
Created task with ID: task_9
Created task with ID: task_10
Finished initializing task queue. Total tasks created: 10
Submitting result for task ID: task_1
Number of created task IDs: 10
Task result submitted successfully
[       OK ] MasterNodeTest.SubmitTaskResult (20 ms)
[ RUN      ] MasterNodeTest.GetAggregatedResults
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
Initializing task queue with 1000 total users and 100 users per task
Created task with ID: task_1
Created task with ID: task_2
Created task with ID: task_3
Created task with ID: task_4
Created task with ID: task_5
Created task with ID: task_6
Created task with ID: task_7
Created task with ID: task_8
Created task with ID: task_9
Created task with ID: task_10
Finished initializing task queue. Total tasks created: 10
Submitting result for task ID: task_1
Number of created task IDs: 10
Task result submitted successfully
Submitting result for task ID: task_10
Number of created task IDs: 9
Task result submitted successfully
[       OK ] MasterNodeTest.GetAggregatedResults (19 ms)
[ RUN      ] MasterNodeTest.SubmitInvalidTaskResult
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
Initializing task queue with 1000 total users and 100 users per task
Created task with ID: task_1
Created task with ID: task_2
Created task with ID: task_3
Created task with ID: task_4
Created task with ID: task_5
Created task with ID: task_6
Created task with ID: task_7
Created task with ID: task_8
Created task with ID: task_9
Created task with ID: task_10
Finished initializing task queue. Total tasks created: 10
Submitting result for task ID: task_0
Number of created task IDs: 10
Task ID not found in createdTaskIds
[       OK ] MasterNodeTest.SubmitInvalidTaskResult (25 ms)
[----------] 6 tests from MasterNodeTest (146 ms total)

[----------] Global test environment tear-down
[==========] 6 tests from 1 test suite ran. (146 ms total)
[  PASSED  ] 6 tests.
<end of output>
Test time =   0.21 sec
----------------------------------------------------------
Test Passed.
"MasterNodeTest" end time: Aug 07 16:07 CEST
"MasterNodeTest" time elapsed: 00:00:00
----------------------------------------------------------

2/4 Testing: DatabaseHandlerTest
2/4 Test: DatabaseHandlerTest
Command: "/home/kylian/Documents/Code/cpp/UserAnalysis/databasehandler_test"
Directory: /home/kylian/Documents/Code/cpp/UserAnalysis
"DatabaseHandlerTest" start time: Aug 07 16:07 CEST
Output:
----------------------------------------------------------
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from DatabaseHandlerTest
[ RUN      ] DatabaseHandlerTest.InsertAndRetrieveLogs
Setting up test environment
Current working directory: "/home/kylian/Documents/Code/cpp/UserAnalysis"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
.env file loaded successfully
Creating DatabaseHandler
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
DatabaseHandler created successfully
Creating search logs table
Creating table: search_logs
Table created successfully
Cleaning up test data
Executing query: DELETE FROM search_logs WHERE user_id BETWEEN 1 AND 100
Query executed successfully
Test data cleaned up
Setup complete
Starting InsertAndRetrieveLogs test
Test logs:
User ID: 1
Search Query: test query 1
Timestamp: 2023-01-01 12:00:00
Search Results: result1 result2 
User ID: 2
Search Query: test query 2
Timestamp: 2023-01-02 13:00:00
Search Results: result3 result4 
Inserting test logs
Inserting multiple search logs
Inserting search log
User ID: 1
Search Query: test query 1
Timestamp: 2023-01-01 12:00:00
Number of search results: 2
Converting vector to Postgres array
Converted array: {"result1","result2"}
Converted search results array: {"result1","result2"}
Creating transaction
Transaction created
Executing query
Query executed
Committing transaction
Transaction committed
Search log inserted successfully
Inserting search log
User ID: 2
Search Query: test query 2
Timestamp: 2023-01-02 13:00:00
Number of search results: 2
Converting vector to Postgres array
Converted array: {"result3","result4"}
Converted search results array: {"result3","result4"}
Creating transaction
Transaction created
Executing query
Query executed
Committing transaction
Transaction committed
Search log inserted successfully
All search logs inserted successfully
Retrieving inserted logs
Executing query: SELECT * FROM search_logs WHERE user_id BETWEEN 1 AND 100 ORDER BY user_id
Query executed successfully
Asserting results
InsertAndRetrieveLogs test completed successfully
Cleaning up test data
Executing query: DELETE FROM search_logs WHERE user_id BETWEEN 1 AND 100
Query executed successfully
Test data cleaned up
[       OK ] DatabaseHandlerTest.InsertAndRetrieveLogs (43 ms)
[ RUN      ] DatabaseHandlerTest.CreateTableIdempotent
Setting up test environment
Current working directory: "/home/kylian/Documents/Code/cpp/UserAnalysis"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
.env file loaded successfully
Creating DatabaseHandler
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
DatabaseHandler created successfully
Creating search logs table
Creating table: search_logs
Table created successfully
Cleaning up test data
Executing query: DELETE FROM search_logs WHERE user_id BETWEEN 1 AND 100
Query executed successfully
Test data cleaned up
Setup complete
Creating table: search_logs
Table created successfully
Creating table: search_logs
Table created successfully
Cleaning up test data
Executing query: DELETE FROM search_logs WHERE user_id BETWEEN 1 AND 100
Query executed successfully
Test data cleaned up
[       OK ] DatabaseHandlerTest.CreateTableIdempotent (26 ms)
[----------] 2 tests from DatabaseHandlerTest (70 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (70 ms total)
[  PASSED  ] 2 tests.
<end of output>
Test time =   0.13 sec
----------------------------------------------------------
Test Passed.
"DatabaseHandlerTest" end time: Aug 07 16:07 CEST
"DatabaseHandlerTest" time elapsed: 00:00:00
----------------------------------------------------------

3/4 Testing: LogGeneratorTest
3/4 Test: LogGeneratorTest
Command: "/home/kylian/Documents/Code/cpp/UserAnalysis/loggenerator_test"
Directory: /home/kylian/Documents/Code/cpp/UserAnalysis
"LogGeneratorTest" start time: Aug 07 16:07 CEST
Output:
----------------------------------------------------------
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from LogGeneratorTest
[ RUN      ] LogGeneratorTest.GeneratesCorrectNumberOfLogs
[       OK ] LogGeneratorTest.GeneratesCorrectNumberOfLogs (0 ms)
[----------] 1 test from LogGeneratorTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
<end of output>
Test time =   0.01 sec
----------------------------------------------------------
Test Passed.
"LogGeneratorTest" end time: Aug 07 16:07 CEST
"LogGeneratorTest" time elapsed: 00:00:00
----------------------------------------------------------

4/4 Testing: WorkerNodeTest
4/4 Test: WorkerNodeTest
Command: "/home/kylian/Documents/Code/cpp/UserAnalysis/workernode_test"
Directory: /home/kylian/Documents/Code/cpp/UserAnalysis
"WorkerNodeTest" start time: Aug 07 16:07 CEST
Output:
----------------------------------------------------------
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from WorkerNodeTest
[ RUN      ] WorkerNodeTest.ProcessTaskTest
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/.env"
Loading .env file from: /home/kylian/Documents/Code/cpp/UserAnalysis/.env
Loaded environment variable: DB_HOST
Loaded environment variable: DB_PORT
Loaded environment variable: DB_NAME
Loaded environment variable: DB_USER
Loaded environment variable: DB_PASSWORD
Initializing DatabaseHandler with config: config.ini
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Found file: "/home/kylian/Documents/Code/cpp/UserAnalysis/config.ini"
Connecting with: host=localhost port=5432 dbname=clients_stats user=kylian password=pass
Connected successfully
Executing query: SELECT search_query FROM search_logs WHERE user_id BETWEEN 1 AND 100
Query executed successfully
No more tasks available. Exiting.
/home/kylian/Documents/Code/cpp/UserAnalysis/tests/WorkerNode_test.cpp:59: Failure
Actual function call count doesn't match EXPECT_CALL(*db_handler_ptr, executeQuery(testing::_))...
         Expected: to be called once
           Actual: never called - unsatisfied and active

[  FAILED  ] WorkerNodeTest.ProcessTaskTest (15 ms)
[----------] 1 test from WorkerNodeTest (15 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (15 ms total)
[  PASSED  ] 0 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] WorkerNodeTest.ProcessTaskTest

 1 FAILED TEST

/home/kylian/Documents/Code/cpp/UserAnalysis/tests/WorkerNode_test.cpp:59: ERROR: this mock object (used in test WorkerNodeTest.ProcessTaskTest) should be deleted but never is. Its address is @0x646413585470.
ERROR: 1 leaked mock object found at program exit. Expectations on a mock object are verified when the object is destructed. Leaking a mock means that its expectations aren't verified, which is usually a test bug. If you really intend to leak a mock, you can suppress this error using testing::Mock::AllowLeak(mock_object), or you may use a fake or stub instead of a mock.
<end of output>
Test time =   0.06 sec
----------------------------------------------------------
Test Failed.
"WorkerNodeTest" end time: Aug 07 16:07 CEST
"WorkerNodeTest" time elapsed: 00:00:00
----------------------------------------------------------

End testing: Aug 07 16:07 CEST
